// ============================================
// Angular Material Global Theme Override
// Modern Green Gradient Theme
// ============================================

@use '@angular/material' as mat;
@use 'sass:map';

// ============================================
// COLOR PALETTE DEFINITION
// ============================================

$primary-palette: (
  0: #000000,
  10: #002b1f,
  20: #00442b,
  25: #005234,
  30: #006b42,
  35: #00845b,
  40: #009d6b,
  50: #34d399,
  60: #6ee7b7,
  70: #a7f3d0,
  80: #d1fae5,
  90: #ecfdf5,
  95: #f0fdf4,
  99: #fafaf9,
  100: #ffffff,
);

$secondary-palette: (
  0: #000000,
  10: #001d33,
  20: #003550,
  25: #004266,
  30: #00527d,
  35: #006296,
  40: #0075b0,
  50: #007dba,
  60: #7dd3fc,
  70: #b3e5fc,
  80: #e1f5fe,
  90: #f0f9ff,
  95: #f5fbff,
  99: #fafbfc,
  100: #ffffff,
);

$tertiary-palette: (
  0: #000000,
  10: #2d1b4d,
  20: #422d63,
  25: #4d3670,
  30: #5c417d,
  35: #6b4c8a,
  40: #7c5899,
  50: #9370c4,
  60: #b08ddd,
  70: #c9b2f0,
  80: #dfc9f9,
  90: #f0e7ff,
  95: #f8f0ff,
  99: #fffbff,
  100: #ffffff,
);

$neutral-palette: (
  0: #000000,
  10: #1a1a1a,
  20: #323232,
  25: #3e3e3e,
  30: #4a4a4a,
  35: #575757,
  40: #636363,
  50: #7e7e7e,
  60: #9a9a9a,
  70: #b6b6b6,
  80: #d3d3d3,
  90: #efefef,
  95: #f7f7f7,
  99: #fefefe,
  100: #ffffff,
);

$error-palette: (
  0: #000000,
  10: #410001,
  20: #680003,
  25: #79000d,
  30: #93000a,
  35: #a80e0e,
  40: #ba1b1b,
  50: #de3b3b,
  60: #ff5449,
  70: #ff897d,
  80: #ffb4ae,
  90: #ffdad6,
  95: #ffedea,
  99: #fffbf9,
  100: #ffffff,
);

// ============================================
// MATERIAL THEME CREATION
// ============================================

$light-theme: mat.define-theme(
  (
    color: (
      primary: $primary-palette,
      secondary: $secondary-palette,
      tertiary: $tertiary-palette,
      neutral: $neutral-palette,
      error: $error-palette,
    ),
  )
);

$dark-theme: mat.define-theme(
  (
    color: (
      primary: $primary-palette,
      secondary: $secondary-palette,
      tertiary: $tertiary-palette,
      neutral: $neutral-palette,
      error: $error-palette,
    ),
  )
);

// ============================================
// APPLY LIGHT THEME
// ============================================

@include mat.all-component-colors($light-theme);

// ============================================
// APPLY DARK THEME
// ============================================

@media (prefers-color-scheme: dark) {
  @include mat.all-component-colors($dark-theme);
}

// ============================================
// GLOBAL MATERIAL COMPONENT OVERRIDES
// ============================================

// *** Button Overrides ***

.mat-mdc-button,
.mat-mdc-raised-button,
.mat-mdc-flat-button,
.mat-mdc-stroked-button {
  border-radius: 8px !important;
  font-weight: 600;
  letter-spacing: 0.5px;
  text-transform: uppercase;
  transition: all 0.3s ease;
  min-height: 44px;
  padding: 12px 24px;

  &:disabled {
    opacity: 0.6;
  }
}

// Primary buttons with gradient
.mat-mdc-raised-button.mat-primary,
.mat-mdc-button.mat-primary {
  background: linear-gradient(135deg, #a7f3d0 0%, #34d399 100%) !important;
  color: white !important;
  box-shadow: 0 8px 16px rgba(52, 211, 153, 0.3) !important;

  &:hover:not(:disabled) {
    transform: translateY(-2px);
    box-shadow: 0 12px 24px rgba(52, 211, 153, 0.4) !important;
  }

  &:active:not(:disabled) {
    transform: translateY(0);
  }

  .mdc-button__ripple {
    background-color: rgba(255, 255, 255, 0.3) !important;
  }
}

// *** Form Field Overrides ***

.mat-mdc-form-field {
  width: 100%;

  // Floating label styling
  .mat-mdc-floating-label {
    color: #064e3b !important;
    font-weight: 500;

    &.mat-form-field-empty.mat-focused {
      color: #34d399 !important;
    }

    &.mat-accent {
      &.mat-form-field-invalid {
        color: #ef4444 !important;
      }
    }
  }

  // Outlined form field border
  .mdc-notched-outline__leading,
  .mdc-notched-outline__notch,
  .mdc-notched-outline__trailing {
    border-color: #d1fae5 !important;
  }

  // Focused state border and background
  &.mat-focused {
    .mdc-notched-outline__leading,
    .mdc-notched-outline__notch,
    .mdc-notched-outline__trailing {
      border-color: #34d399 !important;
      border-width: 2px !important;
    }

    .mat-mdc-form-field-focus-overlay {
      background-color: rgba(52, 211, 153, 0.03) !important;
    }

    .mdc-text-field {
      background-color: rgba(255, 255, 255, 0.8);
    }
  }

  // Error state styling
  &.mat-form-field-invalid {
    .mdc-notched-outline__leading,
    .mdc-notched-outline__notch,
    .mdc-notched-outline__trailing {
      border-color: #ef4444 !important;
    }
  }

  // Input field background
  .mdc-text-field {
    background-color: rgba(240, 253, 250, 0.5) !important;
  }

  // Disabled state
  &.mat-form-field-disabled {
    .mdc-notched-outline__leading,
    .mdc-notched-outline__notch,
    .mdc-notched-outline__trailing {
      border-color: #cbd5e1 !important;
    }

    .mdc-text-field {
      background-color: #f1f5f9 !important;
    }
  }

  // Input element
  .mat-mdc-input-element {
    color: #064e3b !important;
    font-size: 14px;
    padding: 12px 14px;
  }

  // Error message
  .mat-mdc-form-field-error {
    color: #ef4444 !important;
    font-size: 12px;
  }

  // Hint text
  .mat-mdc-form-field-hint {
    color: #64748b !important;
    font-size: 12px;
  }
}

// *** Input Element ***

input.mat-mdc-input-element {
  &::placeholder {
    color: #a0aec0;
  }

  &:disabled {
    opacity: 0.6;
    cursor: not-allowed;
  }
}

// *** Card Overrides ***

mat-card {
  border-radius: 16px !important;
  box-shadow: 0 20px 60px -15px rgba(52, 211, 153, 0.2),
              0 10px 30px -10px rgba(0, 0, 0, 0.08) !important;
  border: 1px solid rgba(209, 250, 229, 0.5) !important;
  background: rgba(255, 255, 255, 0.95) !important;
  backdrop-filter: blur(10px);
  transition: all 0.3s ease;

  &:hover {
    box-shadow: 0 25px 70px -10px rgba(52, 211, 153, 0.3),
                0 10px 35px -5px rgba(0, 0, 0, 0.1) !important;
  }
}

mat-card-header {
  border-radius: 16px 16px 0 0;
  background: linear-gradient(135deg, #a7f3d0 0%, #34d399 100%);
  padding: 32px 24px !important;
  color: white !important;
  position: relative;
  overflow: hidden;

  mat-card-title {
    color: white !important;
    font-size: 28px;
    font-weight: 700;
    letter-spacing: -0.5px;
  }

  mat-card-subtitle {
    color: rgba(255, 255, 255, 0.95) !important;
    font-size: 14px;
    font-weight: 500;
  }
}

mat-card-content {
  padding: 32px 24px !important;
}

mat-card-actions {
  padding: 16px 24px 24px !important;
  display: flex;
  gap: 12px;
  justify-content: flex-end;

  button {
    margin: 0 !important;
  }
}

// *** Icon Overrides ***

mat-icon {
  color: #064e3b !important;

  &.primary {
    color: #34d399 !important;
  }

  &.accent {
    color: #8b5cf6 !important;
  }

  &.warn {
    color: #ef4444 !important;
  }
}

// *** Checkbox Overrides ***

.mat-mdc-checkbox {
  .mdc-checkbox__native-control:checked ~ .mdc-checkbox__background {
    border-color: #34d399 !important;
    background-color: #34d399 !important;
  }

  &.mat-checked {
    .mdc-checkbox__checkmark {
      color: white !important;
    }

    .mat-mdc-checkbox-ripple {
      background-color: rgba(52, 211, 153, 0.1) !important;
    }
  }

  &:disabled {
    opacity: 0.6;
  }
}

// *** Radio Button Overrides ***

.mat-mdc-radio-button {
  .mat-mdc-radio-outer-circle {
    border-color: #d1fae5 !important;
  }

  &.mat-checked {
    .mat-mdc-radio-outer-circle {
      border-color: #34d399 !important;
    }

    .mat-mdc-radio-ripple {
      background-color: rgba(52, 211, 153, 0.1) !important;
    }
  }

  &:disabled {
    opacity: 0.6;
  }
}

// *** Tab Overrides ***

.mat-mdc-tab-group {
  .mat-mdc-tab {
    &.mat-mdc-tab-active {
      .mdc-tab__text-label {
        color: #34d399 !important;
        font-weight: 600;
      }

      .mdc-tab-indicator__content {
        border-color: #34d399 !important;
        background-color: #34d399 !important;
      }
    }

    &:hover {
      .mdc-tab__text-label {
        color: #34d399 !important;
      }
    }
  }
}

// *** Dialog Overrides ***

.mat-mdc-dialog-container {
  border-radius: 16px !important;
  box-shadow: 0 20px 60px -15px rgba(52, 211, 153, 0.2) !important;

  .mat-mdc-dialog-title {
    color: #064e3b;
    font-weight: 600;
  }
}

// *** Tooltip Overrides ***

.mat-mdc-tooltip {
  background-color: #034e3b !important;
  color: white !important;
  border-radius: 6px !important;
  font-size: 12px;
}

// *** Menu Overrides ***

.mat-mdc-menu-panel {
  border-radius: 8px !important;
  box-shadow: 0 10px 30px rgba(52, 211, 153, 0.15) !important;

  .mat-mdc-menu-item {
    &:hover {
      background-color: rgba(52, 211, 153, 0.05) !important;
    }

    &.mat-mdc-menu-item-highlighted {
      background-color: rgba(52, 211, 153, 0.1) !important;
      color: #34d399 !important;
    }
  }
}

// *** Progress Bar Overrides ***

.mat-mdc-progress-bar {
  background-color: #d1fae5 !important;

  .mdc-linear-progress__bar-inner {
    background: linear-gradient(90deg, #a7f3d0 0%, #34d399 100%) !important;
  }
}

// *** Slider Overrides ***

.mat-mdc-slider {
  .mdc-slider__track--active_fill {
    background-color: #34d399 !important;
  }

  .mdc-slider__thumb {
    background-color: #34d399 !important;
  }

  &:hover {
    .mdc-slider__thumb {
      box-shadow: 0 0 12px rgba(52, 211, 153, 0.4) !important;
    }
  }
}

// *** Snackbar Overrides ***

.mat-mdc-snack-bar-container {
  &.mat-primary {
    background-color: #34d399 !important;
    color: white !important;
  }

  &.mat-accent {
    background-color: #8b5cf6 !important;
    color: white !important;
  }

  &.mat-warn {
    background-color: #ef4444 !important;
    color: white !important;
  }

  border-radius: 8px !important;
  box-shadow: 0 8px 24px rgba(52, 211, 153, 0.2) !important;
}

// *** Stepper Overrides ***

.mat-stepper-horizontal,
.mat-stepper-vertical {
  .mat-step-header {
    &.mat-active {
      .mat-step-icon {
        background-color: #34d399 !important;
        color: white !important;
      }

      .mat-step-label {
        color: #34d399 !important;
        font-weight: 600;
      }
    }

    &:hover {
      .mat-step-label {
        color: #34d399 !important;
      }
    }
  }

  .mat-step-icon {
    background-color: #d1fae5 !important;
    color: #064e3b !important;
  }
}

// *** Datepicker Overrides ***

.mat-calendar {
  .mat-calendar-body-selected {
    background-color: #34d399 !important;
    color: white !important;
  }

  .mat-calendar-body-today:not(.mat-calendar-body-selected) {
    border-color: #34d399 !important;
  }

  .mat-calendar-body-hover {
    background-color: rgba(52, 211, 153, 0.1) !important;
  }
}

.mat-datepicker-toggle {
  .mat-icon-button {
    color: #34d399 !important;
  }
}

// *** Expansion Panel Overrides ***

.mat-expansion-panel {
  border-radius: 8px !important;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05) !important;

  &.mat-expanded {
    box-shadow: 0 8px 24px rgba(52, 211, 153, 0.1) !important;
  }

  .mat-expansion-panel-header {
    &:hover {
      background-color: rgba(52, 211, 153, 0.03) !important;
    }

    &.mat-expanded {
      background-color: rgba(52, 211, 153, 0.05) !important;
    }
  }
}

// *** Pagination Overrides ***

.mat-mdc-paginator {
  background-color: rgba(240, 253, 250, 0.5);
  border-top: 1px solid #d1fae5;

  .mat-mdc-paginator-container {
    justify-content: center;

    .mat-mdc-paginator-page-size {
      align-items: center;
    }

    .mat-mdc-icon-button {
      color: #34d399 !important;

      &:disabled {
        color: #cbd5e1 !important;
      }
    }
  }
}

// ============================================
// ANIMATION KEYFRAMES
// ============================================

@keyframes fadeInSlideUp {
  0% {
    opacity: 0;
    transform: translateY(20px);
  }
  100% {
    opacity: 1;
    transform: translateY(0);
  }
}

@keyframes slideInLeft {
  0% {
    opacity: 0;
    transform: translateX(-20px);
  }
  100% {
    opacity: 1;
    transform: translateX(0);
  }
}

@keyframes glow {
  0%, 100% {
    box-shadow: 0 0 20px rgba(52, 211, 153, 0.3);
  }
  50% {
    box-shadow: 0 0 30px rgba(52, 211, 153, 0.5);
  }
}

// ============================================
// RESPONSIVE BREAKPOINTS
// ============================================

@media (max-width: 768px) {
  .mat-mdc-button,
  .mat-mdc-raised-button {
    min-height: 40px;
    padding: 10px 16px;
    font-size: 13px;
  }

  .mat-mdc-form-field {
    margin-bottom: 12px;
  }

  mat-card-header {
    padding: 20px 16px !important;
  }

  mat-card-content {
    padding: 20px 16px !important;
  }
}

@media (max-width: 480px) {
  .mat-mdc-button,
  .mat-mdc-raised-button {
    width: 100%;
  }

  mat-card {
    max-width: 100%;
    border-radius: 12px !important;
  }

  .mat-expansion-panel-header {
    padding: 12px 16px !important;
  }

  .mat-mdc-dialog-container {
    max-width: 100%;
    margin: 16px;
  }
}

// ============================================
// ACCESSIBILITY ENHANCEMENTS
// ============================================

// Focus visible states for keyboard navigation
button:focus-visible,
a:focus-visible,
input:focus-visible,
[role="button"]:focus-visible {
  outline: 2px solid #34d399;
  outline-offset: 2px;
}

// Reduced motion support
@media (prefers-reduced-motion: reduce) {
  *,
  *::before,
  *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
  }
}

// High contrast mode support
@media (prefers-contrast: more) {
  .mat-mdc-button.mat-primary {
    border: 2px solid #059669;
  }

  .mat-mdc-form-field .mdc-notched-outline {
    border-width: 2px !important;
  }
}
